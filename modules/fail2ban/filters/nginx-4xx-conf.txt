####################################################################################################
#### author: SlickStack ############################################################################
#### link: https://slickstack.io ###################################################################
#### mirror: #######################
#### path: /etc/fail2ban/filter.d/nginx-4xx.conf ###################################################
#### destination: n/a (not a boilerplate) ##########################################################
#### purpose: Nginx main configuration file (server block configuration files are separate) ########
#### module version: ##################################################################
#### sourced by: n/a ###############################################################################
#### bash aliases: n/a (ss-install-fail2ban-config) ################################################
####################################################################################################

[Definition] 
failregex = ^<HOST>.*"(GET|POST).*" (404|444|403|400) .*$ 
ignoreregex =

## Ref: https://forum.cleavr.io/t/how-to-block-404-attacks-using-fail2ban/303
## Ref: https://dev.to/armiedema/detect-and-stop-404-attacks-with-fail2ban-1coo
## Ref: https://serverfault.com/questions/1152310/fail2ban-regex-to-filter-all-404-errors-out-of-the-apache-log
## Ref: https://github.com/mariusv/nginx-badbot-blocker
## Ref: https://gist.github.com/JulienBlancher/48852f9d0b0ef7fd64c3
## Ref: https://serverfault.com/questions/849854/fail2ban-blocking-behaviours-depending-on-the-status-code
